<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="BWT demo version">
    <meta name="developer" content="Dmitrijs Kozlovs">
    <title>Baltic Water Temperature</title>
    <link rel="stylesheet" href="../static/homepage.css">
    <style>
        /* Add styles for the table */
        .data-table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }

        .data-table th {
            background-color: #f2f2f2;
        }

        /* Add styles for the fetchDataButton and input elements */
        #fetchDataButton {
            margin-top: 10px;
            padding: 8px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }

        #fromDate,
        #toDate {
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 14px;
        }
        .input-label {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        label {
            font-weight: bold;
            margin-right: 10px;
        }

        /* Style for date inputs with labels */
        .date-input {
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 8px;
            font-size: 14px;
            appearance: none;
            background-color: white;
            display: inline-block;
            vertical-align: middle;
        }

        /* Add styles for the apiDataContainer */
        #apiDataContainer {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<h3 class="title-heading">Baltic Water Temperature</h3>

<div class="buttons-container">
    <a href="/createAccount" class="create-account-link">Create Account</a>
    <a href="/login" class="create-account-link">Login</a>
</div>



<div class="input-label">
    <label for="fromDate">From:</label>
    <input type="date" id="fromDate" class="date-input" placeholder="From Date">
</div>

<div class="input-label">
    <label for="toDate">To:</label>
    <input type="date" id="toDate" class="date-input" placeholder="To Date">
</div>

<button id="fetchDataButton">Find Temperature</button>
<div id="apiDataContainer"></div>

<script>
    const fetchDataButton = document.getElementById('fetchDataButton');
    const apiDataContainer = document.getElementById('apiDataContainer');
    const fromDateInput = document.getElementById('fromDate');
    const toDateInput = document.getElementById('toDate');

    fetchDataButton.addEventListener('click', () => {
        fetchApiData();
    });

    function fetchApiData() {
        const fromDate = fromDateInput.value;
        const toDate = toDateInput.value;
        const formattedFromDate = formatDate(fromDate);
        const formattedToDate = formatDate(toDate);

        fetch(`/fetch-api-data?fromDate=${formattedFromDate}&toDate=${formattedToDate}`)
            .then(response => response.json())
            .then(data => {
                console.log(data);
                displayApiData(data);
            })
            .catch(error => {
                console.error('Error fetching API data:', error);
            });
    }

    function formatDate(dateString) {
        const date = new Date(dateString);
        const year = date.getFullYear();
        const month = ('0' + (date.getMonth() + 1)).slice(-2);
        const day = ('0' + date.getDate()).slice(-2);
        const hours = ('0' + date.getHours()).slice(-2);
        const minutes = ('0' + date.getMinutes()).slice(-2);
        const seconds = ('0' + date.getSeconds()).slice(-2);
        return `${year}-${month}-${day}T${hours}:${minutes}:${seconds}`;
    }

    function displayApiData(data) {
        apiDataContainer.innerHTML = ''; // Clear previous content

        const table = document.createElement('table');
        table.classList.add('data-table');

        const headerRow = document.createElement('tr');
        const headers = ['Date and Time', 'Station ID', 'Abbreviation', 'Value'];
        headers.forEach(headerText => {
            const headerCell = document.createElement('th');
            headerCell.textContent = headerText;
            headerRow.appendChild(headerCell);
        });
        table.appendChild(headerRow);

        data.result.records.forEach(record => {
            const row = document.createElement('tr');

            const datetimeCell = document.createElement('td');
            datetimeCell.textContent = record.DATETIME;
            row.appendChild(datetimeCell);

            const stationCell = document.createElement('td');
            stationCell.textContent = record.STATION_ID;
            row.appendChild(stationCell);

            const abbreviationCell = document.createElement('td');
            abbreviationCell.textContent = record.ABBREVIATION;
            row.appendChild(abbreviationCell);

            const valueCell = document.createElement('td');
            valueCell.textContent = record.VALUE;
            row.appendChild(valueCell);

            table.appendChild(row);
        });

        apiDataContainer.appendChild(table);
    }
</script>



</body>
</html>
